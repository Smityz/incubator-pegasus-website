<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Pegasus | Release History of Pegasus</title>
    <link rel="stylesheet" href="/en/assets/css/app.css">
    <link rel="shortcut icon" href="/en/assets/images/favicon.ico">
    <link href="https://cdn.bootcdn.net/ajax/libs/tailwindcss/1.8.10/utilities.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
    <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.13.0/js/all.min.js"></script>
    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Release History of Pegasus | Pegasus</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Release History of Pegasus" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Release Notes of v2.0.0 (Latest)" />
<meta property="og:description" content="Release Notes of v2.0.0 (Latest)" />
<meta property="og:site_name" content="Pegasus" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-12-14T16:52:37+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Release History of Pegasus" />
<script type="application/ld+json">
{"url":"/releases/","@type":"BlogPosting","headline":"Release History of Pegasus","dateModified":"2020-12-14T16:52:37+00:00","datePublished":"2020-12-14T16:52:37+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"/releases/"},"description":"Release Notes of v2.0.0 (Latest)","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
</head>

  <body>
    



<nav class="navbar is-primary">
    <div class="container">
        <!--container will be unwrapped when it's in docs-->
        <div class="navbar-brand">
            <a href="/en/" class="navbar-item ">
                <!-- Pegasus Icon -->
                <img src="/assets/images/pegasus-icon.png">
            </a>
            <div class="navbar-item">
                <a href="/en/docs" class="button is-primary is-outlined is-inverted">
                    <span class="icon"><i class="fas fa-book"></i></span>
                    <span>Docs</span>
                </a>
            </div>
            <div class="navbar-item is-hidden-desktop">
                  

<!--A simple language switch button that only supports zh and en.-->
<!--IF its language is zh, then switches to en.-->

<!--If you don't want a url to be relativized, you can add a space explicitly into the href to 
    prevents a url from being relativized by polyglot.-->
<a class="button is-primary is-outlined is-inverted" href=" /releases/index.html"><strong>中</strong></a>

            </div>
            <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="navMenu">
                <!-- Appears in mobile mode only -->
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
            </a>
        </div>
        <div class="navbar-menu" id="navMenu">
            <div class="navbar-end">
                
                 <!--dropdown-->
                <div class="navbar-item has-dropdown is-hoverable ">
                    <a href="/en/community"
                        class="navbar-link ">
                        
                        <span class="icon" style="margin-right: .25em">
                            <i class="fas fa-user-plus"></i>
                        </span>
                        
                        <span>
                            Community
                        </span>
                    </a>
                    <div class="navbar-dropdown">
                        
                        <a href="/en/community/#contact-us"
                            class="navbar-item ">
                            Contact Us
                        </a>
                        
                        <a href="/en/community/#contribution"
                            class="navbar-item ">
                            Contribution
                        </a>
                        
                        <a href="https://cwiki.apache.org/confluence/display/PEGASUS/Coding+guides"
                            class="navbar-item ">
                            Coding Guides
                        </a>
                        
                        <a href="https://github.com/apache/incubator-pegasus/issues?q=is%3Aissue+is%3Aopen+label%3Atype%2Fbug"
                            class="navbar-item ">
                            Bug Tracking
                        </a>
                        
                        <a href="https://cwiki.apache.org/confluence/display/INCUBATOR/PegasusProposal"
                            class="navbar-item ">
                            Apache Proposal
                        </a>
                        
                    </div>
                </div>
                
                
                
                <a href="/en/blogs"
                    class="navbar-item ">
                    
                    <span class="icon" style="margin-right: .25em">
                        <i class="fas fa-rss"></i>
                    </span>
                    
                    <span>Blog</span>
                </a>
                
                
                
                <a href="/en/docs/downloads"
                    class="navbar-item ">
                    
                    <span class="icon" style="margin-right: .25em">
                        <i class="fas fa-fire"></i>
                    </span>
                    
                    <span>Releases</span>
                </a>
                
                
            </div>
            <div class="navbar-item is-hidden-mobile">
                

<!--A simple language switch button that only supports zh and en.-->
<!--IF its language is zh, then switches to en.-->

<!--If you don't want a url to be relativized, you can add a space explicitly into the href to 
    prevents a url from being relativized by polyglot.-->
<a class="button is-primary is-outlined is-inverted" href=" /releases/index.html"><strong>中</strong></a>

            </div>
        </div>
    </div>
</nav>

    <section class="section">
        <div class="container">
            <div class="columns is-multiline">
                <div class="column is-one-fourth">
                    
                </div>
                <div class="column is-half">
                    
                    


<div class="content-toc">
    <div class="menu">
        <p class="menu-label">Releases</p>
        <ul class="menu-list">
  <li><a href="#release-notes-of-v200-latest">Release Notes of v2.0.0 (Latest)</a></li>
  <li><a href="#release-notes-of-v1123">Release Notes of v1.12.3</a></li>
  <li><a href="#release-notes-of-v1122">Release Notes of v1.12.2</a></li>
  <li><a href="#release-notes-of-v1121">Release Notes of v1.12.1</a></li>
  <li><a href="#release-notes-of-v1120">Release Notes of v1.12.0</a></li>
  <li><a href="#release-notes-of-v1116">Release Notes of v1.11.6</a></li>
  <li><a href="#release-notes-of-v1115">Release Notes of v1.11.5</a></li>
  <li><a href="#release-notes-of-v1114">Release Notes of v1.11.4</a></li>
  <li><a href="#other-releases">Other Releases</a></li>
</ul>
    </div>
</div>


<div class="content">
    <h1 id="release-notes-of-v200-latest">Release Notes of v2.0.0 (Latest)</h1>

<p>Release page on Github: <a href="https://github.com/XiaoMi/pegasus/releases/tag/v2.0.0">https://github.com/XiaoMi/pegasus/releases/tag/v2.0.0</a></p>

<p><strong>NOTE: 2.0.0 is backward-compatible only, which means servers upgraded to this version can’t rollback to previous versions.</strong></p>

<p>The following are the highlights in this release:</p>

<h2 id="duplication">Duplication</h2>

<p>Duplication is the solution of Pegasus for intra-cluster data copying in real-time. We currently limit our master-master duplication for ‘PUT’ and ‘MULTI_PUT’ only. See this document for more details:
<a href="https://pegasus.apache.org/administration/duplication">https://pegasus.apache.org/administration/duplication</a></p>

<h2 id="backup-request">Backup Request</h2>

<p>Backup Request is a way to eliminate tail latency by sacrificing minor data consistency, fallback reading from a random secondary when the primary read failed to finish at the expected time.
See the discussion here: <a href="https://github.com/XiaoMi/pegasus/issues/251">https://github.com/XiaoMi/pegasus/issues/251</a></p>

<h2 id="rocksdb-meta-cf">RocksDB Meta CF</h2>

<p>Pegasus currently has a hacked version of RocksDB that stores a few metadata in the manifest file, which makes our RocksDB incompatible with the official version. In this version, we exploit an additional column family (called ‘Meta CF’) to store those metadata.</p>

<p>To finally get rid of the legacy RocksDB, you must first upgrade the ReplicaServer to 2.0.0.</p>

<h2 id="bloom-filter-optimization">Bloom Filter Optimization</h2>

<p>This time we support metrics for the utilization of bloom filters in Pegasus. And for critical scenarios, we provide configurations for performance tuning on bloom filters.
See <a href="https://github.com/XiaoMi/pegasus/pull/522">#522</a>, <a href="https://github.com/XiaoMi/pegasus/pull/521">#521</a>.</p>

<h2 id="cold-backup-fds-limit">Cold-Backup FDS Limit</h2>

<p>This feature adds throttling on download and upload during cold-backup.
See <a href="https://github.com/XiaoMi/rdsn/pull/443">XiaoMi/rdsn#443</a>.</p>

<h2 id="adding-node-optimization">Adding Node Optimization</h2>

<p>We previously suffer from the effect brought by data migration when adding one or more nodes into a cluster. In some latency-critical scenarios (here we mostly focus on read-latency) this (3~10 times increase in latency) usually implies the service briefly unavailable.</p>

<p>In 2.0.0 we support a strategy that the newly added nodes do not serve read requests until most migrations are done. Although the new nodes still participate in write-2PC and the overall migration workload doesn’t decrease, the read latency significantly improved thanks to this job.</p>

<p>Be aware that this feature requires merely pegasus-tools to be 2.0.0, you don’t have to upgrade the server to 2.0.0. See <a href="https://github.com/XiaoMi/pegasus/pull/528">#528</a>.</p>

<h1 id="release-notes-of-v1123">Release Notes of v1.12.3</h1>

<p>Release page on Github: <a href="https://github.com/XiaoMi/pegasus/releases/tag/v1.12.3">https://github.com/XiaoMi/pegasus/releases/tag/v1.12.3</a></p>

<p><button class="button release-button" data-target="#modal_v1_12_3">Released at 23/Apr/2020</button></p>

<h1 id="release-notes-of-v1122">Release Notes of v1.12.2</h1>

<p>Release page on Github: <a href="https://github.com/XiaoMi/pegasus/releases/tag/v1.12.2">https://github.com/XiaoMi/pegasus/releases/tag/v1.12.2</a></p>

<p><button class="button release-button" data-target="#modal_v1_12_2">Released at 2/Jan/2020</button></p>

<h1 id="release-notes-of-v1121">Release Notes of v1.12.1</h1>

<p>Release page on Github: <a href="https://github.com/XiaoMi/pegasus/releases/tag/v1.12.1">https://github.com/XiaoMi/pegasus/releases/tag/v1.12.1</a></p>

<p><button class="button release-button" data-target="#modal_v1_12_1">Released at 4/Dec/2019</button></p>

<h1 id="release-notes-of-v1120">Release Notes of v1.12.0</h1>

<p>Release page on Github: <a href="https://github.com/XiaoMi/pegasus/releases/tag/v1.12.0">https://github.com/XiaoMi/pegasus/releases/tag/v1.12.0</a></p>

<p><button class="button release-button" data-target="#modal_v1_12_0">Released at 19/Nov/2019</button></p>

<h1 id="release-notes-of-v1116">Release Notes of v1.11.6</h1>

<p>Release page on Github: <a href="https://github.com/XiaoMi/pegasus/releases/tag/v1.11.6">https://github.com/XiaoMi/pegasus/releases/tag/v1.11.6</a></p>

<p><button class="button release-button" data-target="#modal_v1_11_6">Released at 26/Aug/2019</button></p>

<h1 id="release-notes-of-v1115">Release Notes of v1.11.5</h1>

<p>Release page on Github: <a href="https://github.com/XiaoMi/pegasus/releases/tag/v1.11.5">https://github.com/XiaoMi/pegasus/releases/tag/v1.11.5</a></p>

<p><button class="button release-button" data-target="#modal_v1_11_5">Released at 24/Jun/2019</button></p>

<h1 id="release-notes-of-v1114">Release Notes of v1.11.4</h1>

<p>Release page on Github: <a href="https://github.com/XiaoMi/pegasus/releases/tag/v1.11.4">https://github.com/XiaoMi/pegasus/releases/tag/v1.11.4</a></p>

<p><button class="button release-button" data-target="#modal_v1_11_4">Released at 10/Jun/2019</button></p>

<h1 id="other-releases">Other Releases</h1>

<p>For earlier releases, please refer to <a href="https://github.com/XiaoMi/pegasus/releases">https://github.com/XiaoMi/pegasus/releases</a>.</p>


    
    <div class="modal" id="modal_v1_12_3">
        <div class="modal-background"></div>
        <div class="modal-card">
            <section class="modal-card-body">
                
<h1 id="release-notes-of-v1123">Release Notes of v1.12.3</h1>

<p>The following are the highlights in this release:</p>

<h2 id="new-hotspot-algorithm-support">New Hotspot Algorithm Support</h2>

<p>A new algorithm of hotspot detection is supported here, which makes the following improvements:</p>

<ol>
  <li>It defined the concept of threshold, and ready for automatic monitoring.</li>
  <li>It has higher stability</li>
</ol>

<p>Thanks to @Smityz .</p>

<p>Related PR:</p>

<ul>
  <li>feat(hotspot): new algorithm of hotspot detection (https://github.com/XiaoMi/pegasus/pull/479)</li>
  <li>feat(collector): add statistics for partition hotspot (https://github.com/XiaoMi/pegasus/pull/444)</li>
</ul>

<h2 id="optimization">Optimization</h2>

<p>There are some updates used to optimize memory usage and reduce performance cost.</p>

<p>Related PR:</p>

<ul>
  <li>feat: limit long time rocksdb iteration operation(https://github.com/XiaoMi/pegasus/pull/500)</li>
  <li>feat: forbid large-size-value writes to Pegasus (https://github.com/XiaoMi/rdsn/pull/414)</li>
  <li>feat: add a new app_env to limit scan time (https://github.com/XiaoMi/rdsn/pull/421)</li>
  <li>feat: tcmalloc memory release improvements (https://github.com/XiaoMi/rdsn/pull/435)</li>
</ul>

<h2 id="upgrade-from-the-previous-version">Upgrade from the previous version</h2>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">[replication]</span>
- allow_non_idempotent_write = false
<span class="gi">+ max_allowed_write_size = 1048576 # default = 1MB
+ cold_backup_checkpoint_reserve_minutes = 10
</span>
[pegasus.server]
<span class="err">#</span> cluster level restriction {3000, 30MB, 1000, 30s}
<span class="gi">+ rocksdb_multi_get_max_iteration_count = 3000
+ rocksdb_multi_get_max_iteration_size = 31457280
+ rocksdb_max_iteration_count = 1000
+ rocksdb_iteration_threshold_time_ms = 30000
+ rocksdb_use_direct_reads = true
+ rocksdb_use_direct_io_for_flush_and_compaction = true
+ rocksdb_compaction_readahead_size = 2097152
+ rocksdb_writable_file_max_buffer_size = 1048576
</span><span class="gd">- perf_counter_cluster_name = %{cluster.name}
- perf_counter_enable_falcon = false
- perf_counter_enable_prometheus = false
</span><span class="gi">+ perf_counter_sink = &lt;falcon | prometheus&gt;
</span>
[pegasus.collector]
<span class="gd">- cluster = %{cluster.name}
</span><span class="gi">+ hotspot_detect_algorithm = &lt;hotspot_algo_qps_variance | hotspot_algo_qps_skew&gt; 
</span>
[replication]
<span class="gi">+ cluster_name = %{cluster.name}
</span>
</code></pre></div></div>


            </section>
        </div>
        <button class="modal-close is-large" aria-label="close"></button>
    </div>

    
    <div class="modal" id="modal_v1_12_2">
        <div class="modal-background"></div>
        <div class="modal-card">
            <section class="modal-card-body">
                
<h1 id="release-notes-of-v1122">Release Notes of v1.12.2</h1>

<p>This patch release mainly provides some performance improvement for scan/multiget operations, and also provides more HTTP interfaces.</p>

<h2 id="whats-new-in-this-version">What’s new in this version</h2>

<ul>
  <li>feat(shell): support resolve IP address in dsn/utility (XiaoMi/rdsn#337)</li>
  <li>fix(meta): bind task_tracker for each task in meta server (XiaoMi/rdsn#344)</li>
  <li>fix: fix the bug that threads don’t stop when shared_io_service is released (XiaoMi/rdsn#350)</li>
  <li>feat: add http interface to get perf counter info (XiaoMi/rdsn#349)</li>
  <li>fix: fix meta response state to client during configuration query (XiaoMi/rdsn#354)</li>
  <li>feat(http): add HTTP interfaces to query backup info (XiaoMi/rdsn#342)</li>
  <li>fix(http): add uri decoder for http_server (XiaoMi/rdsn#357)</li>
  <li>feat(http): print help info on root path of the http server (XiaoMi/rdsn#367)</li>
  <li>feat(shell): support resolve IP address in some shell commands (#426)</li>
  <li>feat(collector): add statistics for estimate key number of table (#437)</li>
  <li>feat: add http_server for info collector (#442)</li>
  <li>feat(rocksdb): Adapt prefix bloom filter to speedup scans by hashkey (#438)</li>
</ul>

<h2 id="upgrade-from-the-previous-version">Upgrade from the previous version</h2>

<p><a href="https://github.com/facebook/rocksdb/wiki/Prefix-Seek-API-Changes">Prefix bloom filter</a> is enabled by default, it provides some performance improvement for scan operations, and data is compatible. However, you can disable it by</p>

<div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[pegasus.server]</span>
  <span class="py">rocksdb_filter_type</span> <span class="p">=</span> <span class="s">common</span>
</code></pre></div></div>


            </section>
        </div>
        <button class="modal-close is-large" aria-label="close"></button>
    </div>

    
    <div class="modal" id="modal_v1_12_1">
        <div class="modal-background"></div>
        <div class="modal-card">
            <section class="modal-card-body">
                
<h1 id="release-notes-of-v1121">Release Notes of v1.12.1</h1>

<p>This is a patch release. We strongly recommend you to upgrade to this version instead of using v1.12.0.</p>

<h2 id="whats-new-in-this-version">What’s new in this version</h2>

<ul>
  <li>fix: fix log bug in fmt logging (XiaoMi/rdsn#346)</li>
  <li>feat: optimize tcmalloc release memory (XiaoMi/rdsn#343)</li>
  <li>feat: update config for tcmalloc release memory optimization (#433)</li>
  <li>feat: add a interface to get perf-counters info of all partitions of all apps (#417)</li>
  <li>feat(collector): add statistics for estimate key number of partition (#435)</li>
</ul>

<h2 id="upgrade-from-the-previous-version">Upgrade from the previous version</h2>

<div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[replication]</span>
<span class="err">-</span> <span class="err">mem_release_interval_ms</span>
<span class="err">+</span> <span class="py">mem_release_check_interval_ms</span> <span class="p">=</span> <span class="s">3600000</span>
<span class="err">+</span> <span class="py">mem_release_max_reserved_mem_percentage</span> <span class="p">=</span> <span class="s">10</span>
</code></pre></div></div>


            </section>
        </div>
        <button class="modal-close is-large" aria-label="close"></button>
    </div>

    
    <div class="modal" id="modal_v1_12_0">
        <div class="modal-background"></div>
        <div class="modal-card">
            <section class="modal-card-body">
                
<h1 id="release-notes-of-v1120">Release Notes of v1.12.0</h1>

<p>The following are the highlights in this release:</p>

<h2 id="http-support">HTTP Support</h2>

<p>We exposed many metadata of a Pegasus cluster and some system states of a Pegasus server through HTTP interfaces. Thanks to @Skysheepwang.</p>

<p>Related PR: <a href="https://github.com/XiaoMi/rdsn/pull/280">XiaoMi/rdsn#280</a>, <a href="https://github.com/XiaoMi/pegasus/pull/360">#360</a>, <a href="https://github.com/XiaoMi/rdsn/pull/321">XiaoMi/rdsn#321</a>, <a href="https://github.com/XiaoMi/rdsn/pull/296">XiaoMi/rdsn#296</a></p>

<p>Related Docs: <a href="https://pegasus.apache.org/api/http">https://pegasus.apache.org/api/http</a></p>

<h2 id="multi-tenant-support">Multi-tenant Support</h2>

<p>In XiaoMi as our user base grows, improvements on our multi-tenant support become increasingly needed for stability. For example, we lack monitoring support for table-level latency (only server-level latency). When a table is observed unreasonably slow, we need to refine our slow query mechanism in order to dynamically configure the “slow” threshold per table without system reboot. Another requirement is to support size-based write throttling to reduce the influence of a high-throughput-low-QPS table to other tables in the same cluster.</p>

<p>Related PR: <a href="https://github.com/XiaoMi/rdsn/pull/314">XiaoMi/rdsn#314</a>, <a href="https://github.com/XiaoMi/rdsn/pull/298">XiaoMi/rdsn#298</a>, <a href="https://github.com/XiaoMi/pegasus/pull/400">#400</a>, <a href="https://github.com/XiaoMi/rdsn/pull/336">XiaoMi/rdsn#336</a>, <a href="https://github.com/XiaoMi/rdsn/pull/340">XiaoMi/rdsn#340</a></p>

<p>Docs on table-level latency: TBD</p>

<p>Docs on table-level slow query: TBD</p>

<p>Docs on size-based throttling: TBD</p>

<h2 id="prometheus-support">Prometheus Support</h2>

<p>Pegasus is continuously lowering our access costs for community users. In this release, we provide our experimental support on Promentheus, thanks to @ChenQShmily.</p>

<p>Related PR: <a href="https://github.com/XiaoMi/rdsn/pull/287">XiaoMi/rdsn#287</a>, <a href="https://github.com/XiaoMi/rdsn/pull/284">XiaoMi/rdsn#284</a>, <a href="https://github.com/XiaoMi/pegasus/pull/397">#397</a>, <a href="https://github.com/XiaoMi/pegasus/pull/368">#368</a></p>

<p>Related Docs: TBD</p>

<h2 id="cpu-profiling-support">CPU Profiling Support</h2>

<p>Thanks to @linlinhaohao888.</p>

<p>Related PR: <a href="https://github.com/XiaoMi/rdsn/pull/290">XiaoMi/rdsn#290</a></p>

<p>Related Docs: TBD</p>

<h2 id="bug-fixes">Bug Fixes</h2>

<ul>
  <li>fix: meta unnecessary assert <a href="https://github.com/XiaoMi/rdsn/pull/332">XiaoMi/rdsn#332</a></li>
  <li>fix(coldbackup): delay clean request when chkpting <a href="https://github.com/XiaoMi/rdsn/pull/327">XiaoMi/rdsn#327</a></li>
</ul>

<h2 id="upgrade-from-the-previous-version">Upgrade from the previous version</h2>

<p>No configuration update is needed in this release.</p>

<p>For table-level latency, some new perf-counters are added. Every read/write operation to a table has  two perf-counters (p99&amp;p999) for latency.</p>

<pre><code class="language-txt">replica*eon.replica*table.level.RPC_RRDB_RRDB_PUT.latency(ns)@${for.each.table}
replica*eon.replica*table.level.RPC_RRDB_RRDB_PUT.latency(ns)@${for.each.table}.p999
replica*eon.replica*table.level.RPC_RRDB_RRDB_GET.latency(ns)@${for.each.table}
replica*eon.replica*table.level.RPC_RRDB_RRDB_GET.latency(ns)@${for.each.table}.p999
</code></pre>


            </section>
        </div>
        <button class="modal-close is-large" aria-label="close"></button>
    </div>

    
    <div class="modal" id="modal_v1_11_6">
        <div class="modal-background"></div>
        <div class="modal-card">
            <section class="modal-card-body">
                
<h1 id="release-notes-of-v1116">Release Notes of v1.11.6</h1>

<p>The following are the highlights in this release:</p>

<h2 id="important-bugfix-on-failure-detection">Important bugfix on failure detection!</h2>

<p>This bug occurred a few times in a week in our production. Each time causes one server restart. For user who experiences this bug we suggest you to upgrade to 1.11.6.</p>

<p>Related PR: <a href="https://github.com/XiaoMi/rdsn/pull/272">XiaoMi/rdsn#272</a>, <a href="https://github.com/XiaoMi/rdsn/pull/279">XiaoMi/rdsn#279</a>, <a href="https://github.com/XiaoMi/rdsn/pull/277">XiaoMi/rdsn#277</a></p>

<p>Related Issue: <a href="https://github.com/XiaoMi/pegasus/issues/315">#315</a></p>

<h2 id="stability-fixes">Stability Fixes</h2>

<p>Server connection threshold support: <a href="https://github.com/XiaoMi/rdsn/pull/234">XiaoMi/rdsn#234</a></p>

<p>Whitelist support: <a href="https://github.com/XiaoMi/rdsn/pull/228">XiaoMi/rdsn#228</a>, <a href="https://github.com/XiaoMi/rdsn/pull/226">XiaoMi/rdsn#226</a></p>

<p>Related Docs: <a href="https://pegasus.apache.org/administration/whitelist">https://pegasus.apache.org/administration/whitelist</a></p>

<h2 id="optimization-of-memory-usage">Optimization of Memory Usage</h2>

<p>In XiaoMi, some of our clusters experience unreasonably high memory load. To reduce the unknown-where memory cost we introduce “auto-memory-release”, thanks to @linlinhaohao888.</p>

<p>Currently this feature is disable by default due to severe performance downgrade during each run of memory release.</p>

<p>Related PR: <a href="https://github.com/XiaoMi/rdsn/pull/278">XiaoMi/rdsn#278</a></p>

<p>Related Docs: TBD</p>

<h2 id="upgrade-from-the-previous-version">Upgrade from the previous version</h2>

<div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[core]</span>
<span class="err">-</span> <span class="c">;tool = fastrun
</span><span class="err">-</span> <span class="py">cli_local</span> <span class="p">=</span> <span class="s">false</span>
<span class="err">-</span> <span class="py">cli_remote</span> <span class="p">=</span> <span class="s">false</span>
<span class="err">-</span> <span class="py">start_nfs</span> <span class="p">=</span> <span class="s">false</span>
<span class="err">-</span> <span class="c">;logging_factory_name = dsn::tools::hpc_logger
</span><span class="err">+</span> <span class="py">tcmalloc_release_rate</span> <span class="p">=</span> <span class="s">1.0 # default</span>

<span class="err">-</span> <span class="nn">[tools.hpc_logger]</span>
<span class="err">-</span> <span class="py">per_thread_buffer_bytes</span> <span class="p">=</span> <span class="s">8192</span>

<span class="nn">[threadpool.THREAD_POOL_DEFAULT]</span>
<span class="err">-</span> <span class="py">max_input_queue_length</span> <span class="p">=</span> <span class="s">1024</span>

<span class="nn">[replication]</span>
<span class="err">+</span> <span class="py">duplication_disabled</span> <span class="p">=</span> <span class="s">true</span>
<span class="err">+</span> <span class="py">mem_release_interval_ms</span> <span class="p">=</span> <span class="s">86400000 # 1day</span>
<span class="err">+</span> <span class="py">mem_release_enabled</span> <span class="p">=</span> <span class="s">false # disable by default</span>

<span class="nn">[pegasus.server]</span>
<span class="err">-</span> <span class="py">updating_rocksdb_sstsize_interval_seconds</span> <span class="p">=</span> <span class="s">600</span>
<span class="err">+</span> <span class="py">update_rdb_stat_interval</span> <span class="p">=</span> <span class="s">600</span>

<span class="nn">[task..default]</span>
<span class="err">-</span> <span class="py">fast_execution_in_network_thread</span> <span class="p">=</span> <span class="s">false</span>
</code></pre></div></div>


            </section>
        </div>
        <button class="modal-close is-large" aria-label="close"></button>
    </div>

    
    <div class="modal" id="modal_v1_11_5">
        <div class="modal-background"></div>
        <div class="modal-card">
            <section class="modal-card-body">
                
<h1 id="release-notes-of-v1115">Release Notes of v1.11.5</h1>

<p>Refer to <a href="https://github.com/XiaoMi/pegasus/issues/341">#341</a> for detailed updates.</p>

<p>This is a minor release, including:</p>

<h2 id="improvements-on-capacity-unit">Improvements on Capacity Unit</h2>

<p><a href="https://github.com/XiaoMi/pegasus/pull/339">#339</a>, <a href="https://github.com/XiaoMi/rdsn/pull/261">XiaoMi/rdsn#261</a></p>

<h2 id="http-memory-profiling-support">HTTP memory profiling support</h2>

<p><a href="https://github.com/XiaoMi/rdsn/pull/225">XiaoMi/rdsn#225</a></p>

<h2 id="shell--toolssamplebenchredisproxy-updates">Shell &amp; Tools(sample/bench/redisproxy) updates</h2>

<p>Support of JSON ouput in shell: <a href="https://github.com/XiaoMi/pegasus/pull/329">#329</a>, <a href="https://github.com/XiaoMi/pegasus/pull/290">#290</a>, <a href="https://github.com/XiaoMi/rdsn/pull/254">XiaoMi/rdsn#254</a>, <a href="https://github.com/XiaoMi/rdsn/pull/223">XiaoMi/rdsn#223</a></p>

<p>Support exact match : <a href="https://github.com/XiaoMi/pegasus/pull/303">#303</a></p>

<h2 id="upgrading-from-the-previous-version">Upgrading from the previous version</h2>

<div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[pegasus.collector]</span>
<span class="err">--</span>  <span class="py">cu_stat_app</span> <span class="p">=</span> <span class="s">stat</span>
<span class="err">--</span>  <span class="py">cu_fetch_interval_seconds</span> <span class="p">=</span> <span class="s">8</span>
<span class="err">++</span>  <span class="py">usage_stat_app</span> <span class="p">=</span> <span class="s">stat</span>
<span class="err">++</span>  <span class="py">capacity_unit_fetch_interval_seconds</span> <span class="p">=</span> <span class="s">8</span>
<span class="err">++</span>  <span class="py">storage_size_fetch_interval_seconds</span> <span class="p">=</span> <span class="s">3600</span>
</code></pre></div></div>


            </section>
        </div>
        <button class="modal-close is-large" aria-label="close"></button>
    </div>

    
    <div class="modal" id="modal_v1_11_4">
        <div class="modal-background"></div>
        <div class="modal-card">
            <section class="modal-card-body">
                
<h1 id="release-notes-of-v1114">Release Notes of v1.11.4</h1>

<p>The following are the highlights in this release:</p>

<h2 id="support-capacity-unit-calculation">Support Capacity Unit Calculation</h2>

<p>To meet the demand for cost and pricing of Pegasus, we introduce “Capacity Unit” in this release. This concept is equivalent to AWS DynamoDB’s “Request Unit”, and HBase’s “Capacity Unit”.</p>

<p>Related PR: <a href="https://github.com/XiaoMi/pegasus/pull/318">#318</a>, <a href="https://github.com/XiaoMi/rdsn/pull/239">XiaoMi/rdsn#239</a>, <a href="https://github.com/XiaoMi/rdsn/pull/253">XiaoMi/rdsn#253</a>
Related Docs: TBD
Related Issues:</p>

<h2 id="bug-fixes">Bug Fixes</h2>

<ul>
  <li>
    <p>bugfix: too much error logs by write-throttling reject (<a href="https://github.com/XiaoMi/rdsn/pull/243">XiaoMi/rdsn#243</a>)</p>
  </li>
  <li>
    <p>bugfix: add debug logs for failure detection (<a href="https://github.com/XiaoMi/rdsn/pull/256">XiaoMi/rdsn#256</a>)</p>
  </li>
  <li>
    <p>bugfix: fix simple_logger gc log file problem (<a href="https://github.com/XiaoMi/rdsn/pull/258">XiaoMi/rdsn#258</a>)</p>
  </li>
  <li>
    <p>bugfix: http_message_parser (<a href="https://github.com/XiaoMi/rdsn/pull/259">XiaoMi/rdsn#259</a>)</p>
  </li>
  <li>
    <p>bugfix: pegasus_server: fix set usage scenario problem when open db (<a href="https://github.com/XiaoMi/pegasus/pull/334">#334</a>)</p>
  </li>
</ul>

<h2 id="perf-counters">Perf-Counters</h2>

<p>The new perf counters introduced are:</p>

<h2 id="upgrades-from-the-previous-version">Upgrades from the previous version</h2>

<div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[pegasus.server]</span>
<span class="err">...</span>
<span class="py">perf_counter_read_capacity_unit_size</span> <span class="p">=</span> <span class="s">4096</span>
<span class="py">perf_counter_write_capacity_unit_size</span> <span class="p">=</span> <span class="s">4096</span>

<span class="nn">[pegasus.collector]</span>
<span class="err">...</span>
<span class="py">cu_stat_app</span> <span class="p">=</span> <span class="s">stat</span>
<span class="py">cu_fetch_interval_seconds</span> <span class="p">=</span> <span class="s">8</span>

<span class="nn">[task.RPC_RRDB_RRDB_PUT]</span>
<span class="err">...</span>
<span class="err">profiler::</span><span class="py">size.request.server</span> <span class="p">=</span> <span class="s">true</span>

<span class="nn">[task.RPC_RRDB_RRDB_MULTI_PUT]</span>
<span class="err">...</span>
<span class="err">profiler::</span><span class="py">size.request.server</span> <span class="p">=</span> <span class="s">true</span>

<span class="nn">[task.RPC_RRDB_RRDB_GET_ACK]</span>
<span class="err">...</span>
<span class="err">profiler::</span><span class="py">size.response.server</span> <span class="p">=</span> <span class="s">true</span>

<span class="nn">[task.RPC_RRDB_RRDB_MULTI_GET_ACK]</span>
<span class="err">...</span>
<span class="err">profiler::</span><span class="py">size.response.server</span> <span class="p">=</span> <span class="s">true</span>
</code></pre></div></div>


            </section>
        </div>
        <button class="modal-close is-large" aria-label="close"></button>
    </div>
</div>
                </div>
                <div class="column is-one-fourth is-hidden-mobile" style="padding-left: 3rem">
                    
                </div>
            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="content is-small has-text-centered">
            <div style="margin-bottom: 20px;">
                <a href="http://incubator.apache.org"><img src="/assets/images/egg-logo.png"
                                                           alt="Apache Incubator"/></a>
            </div>
            Copyright &copy; 2020 <a href="http://www.apache.org">The Apache Software Foundation</a>.
            Licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version
            2.0</a>.
            <br><br>
            
            Apache Pegasus is an effort undergoing incubation at The Apache Software Foundation (ASF),
            sponsored by the Apache Incubator. Incubation is required of all newly accepted projects
            until a further review indicates that the infrastructure, communications, and decision making process
            have stabilized in a manner consistent with other successful ASF projects. While incubation status is
            not necessarily a reflection of the completeness or stability of the code, it does indicate that the
            project has yet to be fully endorsed by the ASF.
            
        </div>
    </div>
</footer>
    <script src="/assets/js/app.js" type="text/javascript"></script>
  </body>
</html>
